<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="ferp.dao.C2_Dao">

	<!-- 본사/매장 재고 조회 -->
	<select id="r8101ProductList" resultType="productProdOrder" parameterType="productProdOrder">
		SELECT p.*, s.stockDate, s.REMAINAMOUNT 
		FROM PRODUCT p, STOCK s
		WHERE p.PRODUCTNUM = s.PRODUCTNUM
		AND s.STOCKDATE = (SELECT MAX(STOCKDATE) FROM STOCK s2 WHERE s2.PRODUCTNUM = p.PRODUCTNUM)
		AND stockDate LIKE '%'|| to_date(#{stockDate},'YYYY-MM-DD')||'%'
		AND p.productNum LIKE '%'||upper(#{productNum})||'%'
		AND category LIKE '%'||#{category}||'%'
		AND productName LIKE '%'||#{productName}||'%'
		AND opposite LIKE '%'||#{opposite}||'%'
		AND s.frRegiNum = #{frRegiNum,jdbcType=VARCHAR}
	</select>
	
	<!-- 본사/매장 재고 상세 페이지 -->
	<select id="r8101ProductInfo" resultType="product" parameterType="string">
		SELECT *
		FROM PRODUCT
		WHERE productNum like '%'||#{productNum,jdbcType=VARCHAR}||'%'
	</select>
	
	<!-- 매장 재고 관리 등록 -->
	
	<!-- 매장 재고 관리 조회 -->
	
	<!-- 매장 재고 관리 수정 -->
	
	<!-- 매장 재고 관리 삭제 -->
	
	<!-- 본사 재고 등록 -->
	<insert id="r8202ProductIns" parameterType="product">
		INSERT INTO PRODUCT
		values('PD'||FERD.PDSEQ.NEXTVAL,#{category},
		#{productName},#{opposite},#{price},#{img},#{remark})
	</insert>
	
	<!-- 본사 재고 수정 -->
	<update id="r8203ProductUpt" parameterType="product">
		UPDATE PRODUCT 
		SET REMARK  = #{remark}
		WHERE PRODUCTNUM = #{productNum,jdbcType=VARCHAR}
	</update>
	
	<!-- 본사 재고 관리 조회 -->
	
	<!-- 발주 상태 콤보 -->
	<select id="orderStateCom" resultType="string">
		SELECT DISTINCT orderState
		FROM PRODORDER
	</select>
	
	<!-- 직원스케줄 캘린더 -->
	<resultMap type="scheduleCalender" id="calMap">
		<result column="frRegiNum" property="writer"/>
		<result column="onDay" property="start"/>
		<result column="offDay" property="end"/>
	</resultMap>
	<select id="sclerkschd" resultMap="calMap">
	SELECT * FROM clerkSchedule
	WHERE frRegiNum = #{writer}
	</select>
	
</mapper>